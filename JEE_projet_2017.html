<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>IFI - Projet JEE</title>
  <link type="text/css" rel="stylesheet" href="https://stackedit.io/res-min/themes/blue.css" />
<style>
body {
  background-image: url('css/mooc_bg.jpg');
  background-position: bottom right;
  background-repeat: no-repeat;
}
.content { 
  width: 960px; margin: 0 auto; 
  /* background-color: white;  */
  padding: 0 10px 100px 0; 
  }
em { margin-top: 20px; color: #000090 } 
em + p {
  margin-top: 10px;
  color: #CCCCCC;
}
.titre, h1 {
  float: left;
}
h1 {
  width: 300px;
  margin-left: 50px;
}
h1+p {
  clear: both;
}
</style>
</head>
<body>
  
  <div class="content">

<p class="titre">
  <img src="http://www.univ-lille1.fr/digitalAssets/38/38040_logo-trans.png" alt="Université Lille 1" title=""/>
</p>
<h1 id="ifi-projet-jee">IFI - Projet JEE</h1>

<p><strong>Session initiale master e-services FA 2017-2018</strong></p>

<p>
  Nous vous proposons de continuer le développement du commerce en ligne "Web Drive" autours de différents lots fonctionnels : 
  
  <ul>
   <li><a href="#creneaux">Gestion de créneaux</a>, </li>
   <li><a href="#stocks">Référencement de produits et stocks</a>, </li>
   <li><a href="#promos">Promos</a>, </li>
   <li><a href="#paiement">Paiement</a>, </li>
   <li><a href="#preparation">Préparation des commandes</a>, </li>
   <li><a href="#retrait">Retrait des commandes</a>.</li>
  </ul>
  Chaque lot sera développé par une équipe différente - <a href="#equipes">voir les équipes</a> -<br/>
  Les fonctions et données nécessaires à une équipe qui ne seraient pas dans leur lot seront simulées ("mockés") au plus simple.
</p>

<p>
  Les personnes susceptibles d'utiliser l'application sont :<br/>
  - Administrateur du drive (admin),<br/>
  - Les préparateurs de commande (employés),<br/>
  - Les visiteurs du site (clients),<br/>
  - Les banquiers (pour la partie paiement).<br/>
</p>

<p>
  Les fonctions attendues sont ensuite décrites sous forme de "User-Story" regroupées en "Epic" (lot fonctionnel).
</p>


<h2 id="liste-des-fonctionnalités"><i class="icon-list"></i> Liste des fonctionnalités</h2>

<a name="creneaux"></a>
<h3><i class="icon-folder-empty"></i> Gestions des créneaux</h3>

<p><i class="icon-tag"></i> 
  <em>En tant qu'administrateur je peux voir, créer et modifier des créneaux "standards" qui seront choisis par les client pour retirer leurs commandes</em>
</p>
<p>
  Un créneau standard est défini entre deux heures d'une journée de la semaine, chaque créneau possède une capacité de commande. C'est la limite du nombre de commandes qui peuvent être livrées par les employés du drive. Un créneau standard n'est pas lié à une date précise, il se répète indéfiniment chaque semaine.<br/>
  <b>Affichage.</b><br/>
  Les créneaux seront regroupés par jour et triés par heure de début.<br/>
  Sur la liste il sera facile de voir l'heure de début et de fin de chaque créneau.<br/>
  Il serait intéressant que la taille des blocs soit proportionnelle à la durée de chaque créneau.<br/>
  En cliquant sur un créneau existant un formulaire permet de modifier les paramètres de ce créneau.<br/>
  <b>Saisie.</b><br/>
  Sur la liste un lien permet d'afficher un formulaire de saisie d'un nouveau créneau.<br/>
  Je peux choisir le jour de la semaine, l'heure de début (heure et minute), l'heure de fin et la capacité de commande.<br/>
  Contrôle de saisie : heure début &lt; heure de fin, heure début &gt; 8h00, heure fin &lt; 20h00, capacité &gt; 0<br/>
  Si deux créneaux se superposent, je peux tout de même les saisir, mais un message me notifiera quels créneaux se chevauchent.<br/>
  <b>Modification.</b><br/>
  Le formulaire est identique à celui de saisie, je peux tout modifier, avec les mêmes contrôles.
</p>

<p><i class="icon-tag"></i> 
  <em>En tant qu'administrateur je peux saisir et paramétrer des jours fériés afin qu'un client ne puisse pas commander un retrait ce jour là</em>
</p>
<p>
  Les jours fériés sont associés à une date et possèdent un nom, exemple : "Noël".<br/>
  Une liste me présente l'ensemble des jours fériés, je peux en supprimer un ou plusieurs rapidement.<br/>
  Je peux créer un nouveau jour férié en précisant la date (jour/mois/année) et son nom.<br/>
</p>

<p><i class="icon-tag"></i> 
  <em>En tant qu'administrateur je peux définir des créneaux d'ouverture exceptionnelle afin de proposer le retrait des commandes, un jour donné, même si il est férié ou si il ne possède pas de créneaux standards</em>
</p>
<p>
  Sur le même principe que les créneaux standards, sauf que je saisis la date du créneaux (jour/mois/année).<br/>
  Une liste affiche l'ensemble des créneaux exceptionnels à venir (date supérieure à aujourd'hui).<br/>
  Les créneaux sont regroupés par jour et triés par date de début.<br/>
  Je peux les modifier et en ajouter avec les même règles que les créneaux standards.
</p>

<p><i class="icon-tag"></i> 
  <em>En tant que client, lorsque je valide mon panier, je choisis un créneau disponible parmi les 6 prochains jours afin de planifier mon retrait.</em>
</p>
<p>
  Avant de transformer le panier en commande, le créneau de retrait doit être choisi.<br/>
  Afin de faciliter les tests, il sera possible de choisir une date que le système prendra en compte plutôt que la date du jour.<br/>
  Cette date devra être passée en paramètre de la page de choix du créneau.<br/>
  Les créneaux d'ouverture exceptionnels sont prioritaires sur les jours fériés et les créneaux standards.<br/>
  Je ne peux choisir un créneau que si, pour celui-ci, il n'y a pas déjà un nombre de commandes supérieur ou égal à sa capacité.<br/>
  Je ne peux choisir un créneau que si il démarre dans au moins 1 heure.<br/>
  Je choisis le créneau et je valide.<br/>
  Une page me confirme la validation de ma commande et me précise la date et l'heure du retrait.<br/>
  Cette commande est associée à ce créneau dans la base de données.
</p>

<a name="stocks"></a>
<h3><i class="icon-folder-empty"></i> Référencement de produits et stock</h3>

<p><i class="icon-tag"></i>
  <em>En tant qu'administrateur je peux gérer les produits de ma base article.</em>
</p>
<p>
  Une page de recherche me propose des critères de recherche : catégorie (sous la forme d'une liste déroulante), un texte contenu dans le nom du produit, la référence exacte du produit.<br/>
  Je peux saisir un ou plusieurs critères de recherche, une liste paginée me propose les produits correspondants à ces critères.<br/>
  Je peux choisir de paginer les produits par 10, 50 ou 200.<br/>
  La liste se présentera sous la forme d'un tableau présentant la référence, le nom, le prix du produit.<br/>
  En cliquant sur un produit un formulaire me permet de modifier l'ensemble des informations du produit.<br/>
  Je peux ajouter un produit via un lien "Nouveau" présent sur la liste et me présentant un formulaire vierge pour saisir toutes les informations du produit.<br/>
</p>

<p><i class="icon-tag"></i>
  <em>En tant qu'administrateur je peux gérer les stocks de mes produits afin de ne présenter sur le site que les produits en stock.</em>
</p>
<p>
  Ajouter une information de stock sur les produits permettant de gérer les produits classique (n'ayant pas de date de péremption) et les produits périssable.<br/>
  Attention, les stocks des produits périssables devront être distingués par date de péremption.<br/>
  Modifiez les écrans de saisie des produits classiques pour permettre la saisie et la modification rapide des stocks.<br/>

</p>

<p><i class="icon-tag"></i>
  <em>En tant qu'administrateur je peux enregistrer un arrivage de denrées périssables.</em>
</p>
<p>
  Une page dédiée me permet de saisir la référence d'un produit périssable, la date limite de consommation, le lot, la quantité reçue.<br/>
  Ajoutez une entrée de stock pour cet arrivage.<br/>
  Il faudra peut-être modifier votre modèle pour pouvoir avoir plusieurs stock d'un même produit périssable.<br/>
</p>

<p><i class="icon-tag"></i>
  <em>En tant qu'administrateur je peux voir les produits dont la DLC (date limite de consommation) est dépassée.</em>
</p>
<p>
  Une page dédiée me permet de voir toutes les entrées de stock pour lesquelles la date de consommation est dépassée.<br/>
  Je peux supprimer cette entrée de stock afin d'indiquer que j'ai jeté les produits concernés.<br/>
</p>

<p><i class="icon-tag"></i>
  <em>En tant qu'employé je peux ajuster le stock d'un produit à partir de la liste d'une commande.</em>
</p>
<p>
  Une page présentant la liste des articles d'une commande retrouvée par son numéro, permet à l'employé de remettre en stock un produit qui serait finalement refusé par le client à la livraison, ou qui serait retourné non déballé dans les 7 jours.<br/>
  Les refus de produits périssables ne génèrent pas de rajout au stock, ils sont simplement considérés détruits.<br/>
  Un retour de produit ne peut être enregistré que si la date de retrait est inférieure à 7 jours.
</p>

<p><i class="icon-tag"></i>
  <em>En tant que client je ne peux commander que des produits encore en stock et dont la durée de péremption est supérieure à 5 jours.</em>
</p>
<p>
  Modifiez la présentation des produits par catégories pour n'afficher que les produits en stock (produits standards).<br/>
  Seuls les produits périssables dont la date de consommation d'une entrée de stock est supérieure à 5 jours seront affichés.<br/>
  Lors de la validation de commande, venez enregistrer les variations de stocks pour impacter les quantités restantes.<br/>
</p>



<a name="promos"></a>
<h3><i class="icon-folder-empty"></i> Gestion des promotions</h3>

<p><i class="icon-tag"></i>
  <em>En tant que client je ne peux ajouter plusieurs fois le même article, ce qui revient à spécifier une quantité d'article dans le panier.</em>
</p>
<p>
  Actuellement le modèle de données ne permet par de préciser une quantité d'article au panier, modifiez le modèle.<br/>
  Puis vous modifierait si besoin l'interface pour pouvoir préciser ajouter plusieurs articles au panier.<br/>
  Dans le cadre de cette fonction, vous modifierez également l'affichage des listes de produit afin de voir rapidement les produits qui se trouvent déjà dans mon panier. Les articles déjà dans mon panier doivent être identifiable facilement.<br/>
</p>

<p><i class="icon-tag"></i>
  <em>En tant que qu'administrateur je peux ajouter une promotion afin de dynamiser les ventes d'un produit</em>
</p>
<p>
  Une page d'admin me permet de saisir une promotion.<br/>
  je viens renseigner une référence, le système recherche le produit correspondant, et si il existe ...<br/>
  je viens préciser une date de début de promo, une date de fin, je renseigner un pourcentage de réduction OU une valeur de réduction.<br/>
  modifier les listes de produit afin de visualiser la promotion. Vous ferez apparaitre le prix d'origine (prix barré), et le prix en cours.<br/>
  La promo ne s'affiche que si elle est dans sa période de validité (entre les date de début et fin).<br/>
</p>

<p><i class="icon-tag"></i>
  <em>En tant que qu'administrateur je peux gérer une promotion sur un ensemble de produits facilement</em>
</p>
<p>
  En extension de l'usage précédant, il doit être facile, pour un admin,<br/>
  d'appliquer une promotion à un ensemble de produits selon des critères :<br/>
  la catégorie du produit, la marque du produit (que vous ajouterez au modèle), les produits proches de la date de péremption.<br/>
  Cette application de promo ne sera pas dynamique, les produits ajoutés (ou modifiés) qui rempliraient ces conditions ne seront pas 
  impactés par la promotion choisie par l'administrateur.<br/>
</p>

<p><i class="icon-tag"></i>
  <em>En tant que qu'administrateur je peux définir une opération marketing simple sur l'ensemble du panier.</em>
</p>
<p>
  Comme pour les promotions ces opérations ne s'appliquent qu'entre deux dates.<br/>
  Les opérations marketing simple peuvent être limitées en nombre (ex: uniquement pour les 100 premiers clients validant leur panier).<br/>
  Elle peuvent nécessiter la saisie d'un code promo qui serait par exemple diffusé à la télé ou dans un prospectus (ex: PROMO25).<br/>
  Dans tous les cas ces opérations marketing simple ne seront applicable à un client qu'une seule fois.<br/>
  La réduction du panier se fait en pourcentage ou en valeur, mais le montant du panier ne pourra pas avoir une valeur inférieure à 0 !<br/>
  Vous ferez une page d'administration permettant de lister, ajouter/modifier et supprimer ces opérations simples.<br/>
  Vous 
</p>

<p><i class="icon-tag"></i>
  <em>En tant que qu'administrateur je peux définir une opération marketing sous condition d'achat de plusieurs produits.</em>
</p>
<p>
  Ce type d'opération ne sera valable que sur un groupe de produits sélectionnés par l'administrateur.<br/>
  Encore une fois entre deux dates définies.<br/>
  Il existera 3 types d'offres avancées :<br/>
  - l'opération "X + 1 gratuit" où X sera paramétrable, le produit offert sera le moins cher.<br/>
  - le 2e à X%, le moins cher des deux.<br/>
  - le lot de X à Y Euros.<br/>
  Ces opérations sont ordonnées, on viendra appliquer les promos selon leur ordre.<br/>
  Dans cet ordre, les produits d'un panier ayant bénéficié d'une opération ne sont pas candidats pour déclencher une autre opération sur le panier.<br/>
  Modifier le panier pour faire apparaitre ces opérations marketing.<br/>
  Le montant du panier avant et après toutes les réductions doit être affiché.
</p>


<a name="paiement"></a>
<h3><i class="icon-folder-empty"></i> Paiement des commandes</h3>

<p><i class="icon-info"></i>
  <i>informations générales pour ce lot fonctionnel</i>
</p>
<p>
  L'organisme bancaire est dissocié du magasin.<br/>
  Vous gérerez le site bancaire sous la forme d'un war différent !<br/>
  Par simplicité pour la correction, l'ensemble des sources restera sur le même projet git, mais dans deux répertoires différents à la racine du git.<br/>
  Chaque site (banque, commerce), sera un projet maven différent.<br/>
  Les deux war devraient pouvoir fonctionner dans deux tomcats différents.<br/>
</p>

<p><i class="icon-tag"></i>
  <em>En tant qu'organisme bancaire, je peux gérer des commerçants afin qu'ils puissent diriger leurs clients sur ma page de paiement.</em>
</p>
<p>
  Une page d'admin me permet de gérer (liste paginée, ajout, modification et suppression) des commerçants.<br/>
  Les informations concernant un commerçant sont :<br/>
  son code commerçant, unique, qui pourra me servir à le rechercher. Il est saisi par l'admin.<br/>
  son nom.<br/>
  son numéro de compte IBAN (voir <a href="https://www.iban.fr/">ici</a>) que vous contrôlerez au moyen de la clé, voir <a href="https://www.iban.fr/calcul-chiffre-de-controle.html">ici</a><br/>
</p>

<p><i class="icon-tag"></i>
  <em>En tant que commerçant, je peux diriger mes clients vers une page de paiement gérée par la banque afin de percevoir le montant d'une commande.</em>
</p>
<p>
  Lors de la validation d'un panier, afficher une page indiquant le montant total du panier.<br/>
  Afficher un bouton "payez".<br/>
  Lorsque je clique sur ce bouton, je suis redirigé vers la page de paiement de la banque, il sera nécessaire d'envoyer en paramètre : le numéro de panier, le montant à payer, mon numéro de commerçant, une URL de confirmation de paiement.<br/>
  A cette étape, le panier n'est pas encore transformé en commande !<br/>
  Ce ne sera le cas que lorsque le client reviendra sur la page de confirmation et que la banque m'aura passé en paramètre la confirmation de paiement.<br/>
</p>


<p><i class="icon-tag"></i>
  <em>La banque présente une page de paiement selon les paramètres indiqués par le commerçant afin d'enregistrer la transaction bancaire d'un client.</em>
</p>
<p>
  Il s'agira d'une page, qui présentera le nom du commerçant, et le montant à payer.<br/>
  Cette page acceptera en paramètre une URL sur laquelle, une fois le paiement effectué, une redirection du client sera effectuée.<br/>
  Le numéro de commande sera également utile.<br/>
  Cette page invitera le client à saisir son numéro de carte bancaire, la date d'expiration (mois/année), et le code de vérification à 3 chiffres.<br/>
  Un bouton permettra d'annuler le paiement.<br/>
  Un autre bouton permettra, après saisie de la carte, de valider la demande de paiement.<br/>
</p>

<p><i class="icon-tag"></i>
  <em>La banque notifie le commerçant du résultat du paiement après saisie du numéro de carte du client.</em>
</p>
<p>
  Afin de simuler différentes situations de paiement vous accepterez les numéros de carte suivantes :<br/>
  5131 0000 0000 0010 : paiement accepté<br/>
  5131 0000 0000 0020 : paiement refusé<br/>
  tout autre carte : erreur de paiement.<br/>
  Après contrôle de la carte, redirigez l'utilisateur vers l'url fournie par le commerçant.<br/>
  Cette redirection contiendra des paramètres permettant au commerçant de vérifier l'état du paiement :<br/>
  code = (10: accepté, 20: paiement refusé par la banque, 30: paiement annulé par le client, 90: erreur)<br/>
  commande = le numéro de commande qui a été fourni par le commerçant lors de la demande de paiement.<br/>
  montant = le montant qui a été payé par le client.<br/>
  transaction = un numéro identifiant de manière unique ce paiement.<br/>
  date et heure du paiement.
</p>

<p><i class="icon-tag"></i>
  <em>Chaque soir la banque effectue un appel vers une url pour chaque transaction effectuée afin de confirmer les ordres de paiement et éviter les problèmes de redirection des clients.</em>
</p>
<p>
  Vous prévoyez un programme (un main java) qui effectue les notification d'un commerçant dont le numéro est passé en paramètre de la commande.<br/>
  L'url d'appel sera configurée via la fiche du commerçant (admin commerçant).<br/>
  Les appels se feront en POST.<br/>
  Un appel sera effectué par transaction, les appels étant espacés de 500 ms.<br/>
  Les paramètres seront identiques à ceux de la redirection.<br/>
  Si l'appel échoue, il sera relancé le lendemain, les autres confirmations continueront de s'exécuter.<br/>
  Si 10 appels consécutifs échouent, le traitement est interrompu. Les notifications pourront être exécutées le lendemain.<br/>
</p>

<p><i class="icon-tag"></i>
  <em>En tant que commerçant, je confirme le paiement au client et je transforme son panier en commande.</em>
</p>
<p>
  Lorsque la page de confirmation de paiement est appelée par la banque, je vérifie que le paiement est accepté est je transforme le panier en commande.<br/>
  J'enregistre le numéro de transaction bancaire pour pouvoir contester ou vérifier auprès de la banque les ordres de paiements.<br/>
  En cas d'erreur, j'affiche un message à l'utilisateur et je l'invite à re-tenter un paiement.<br/>
  Dans le cadre de cette fonction, vous ferez également une servlet (ou un contrôleur REST), qui accepte les requêtes de notifications journalière de transaction.<br/>
  Pour chacune, vous vérifiez si le panier a déjà été transformé en commande et si les informations de transaction sont bien renseigné, sinon vous le réalisé à ce moment là.<br/>
</p>


<a name="preparation"></a>
<h3><i class="icon-folder-empty"></i> Préparation des commandes</h3>

<pre>
  - pouvoir ajouter :
      - des informations d'allée et d'emplacement sur les produits
      - les informations de zone de conservation produit (surgelé, frais, ambiant)
  - ajouter une gestion de picking par allée
  - ajouter une gestion de constitution des commandes par zone
</pre>


<a name="retrait"></a>
<h3><i class="icon-folder-empty"></i> Retrait des commandes</h3>

<pre>
  - gérer des quais de chargement (numéro, disponibilité en fonction de jours)
  - permettre l'enregistrement d'un client sur borne et lui assigner un emplacement de retrait
  - affichage des commandes en zone de retrait, gestion de prise en charge d'une livraison par employé
  - scan (ou saisie) d'un numéro de ticket, notification de fin de chargement, libération du quai
  - statistiques de commandes retirées par heure, par employé
</pre>


<a name="equipes"></a>
<h2 id="users"><i class="icon-user"></i> Liste des groupes</h2>

<table>
<tr>
  <th>Groupe</th>
  <th>Sujet</th>
  <th>1</th>
  <th>2</th>
  <th>3</th>
  <th>4</th>
</tr>
<tr>
  <td>A</td>
  <td>Créneaux</td>
  <td>xxx</td>
  <td>xxx</td>
  <td>xxx</td>
  <td>xxx</td>
</tr>
<tr>
  <td>B</td>
  <td>Stock</td>
  <td>xxx</td>
  <td>xxx</td>
  <td>xxx</td>
  <td>xxx</td>
</tr>
<tr>
  <td>C</td>
  <td>Promos</td>
  <td>xxx</td>
  <td>xxx</td>
  <td>xxx</td>
  <td>xxx</td>
</tr>
<tr>
  <td>D</td>
  <td>Paiement</td>
  <td>xxx</td>
  <td>xxx</td>
  <td>xxx</td>
  <td>xxx</td>
</tr>
<tr>
  <td>E</td>
  <td>Préparation</td>
  <td>xxx</td>
  <td>xxx</td>
  <td>xxx</td>
  <td>xxx</td>
</tr>
<tr>
  <td>F</td>
  <td>Retrait</td>
  <td>xxx</td>
  <td>xxx</td>
  <td>xxx</td>
  <td>xxx</td>
</tr>
</table>

<h2 id="livrable"><i class="icon-login"></i> Livrable</h2>

<p><i class="icon-user"></i> Le projet est à réaliser par groupe de 4.  <br>
<i class="icon-calendar"></i> Il est à rendre pour le 15 DECEMBRE 2017 AVANT 22h00. <br>
<i class="icon-folder-open"></i> Partagez-moi un projet bitbucket nommé "JEE-PJ17-<b>VOTRE_GROUPE</b>" contenant les sources d’un projet maven et vos ressources web (vues, images, styles, scripts …)</p>

<p>Les dépendances Maven ne seront pas fournies, elles doivent pouvoir être récupérées en utilisant “mvn compile”. <br>
Votre projet utilisera spring, sera organisé selon un pattern MVC mettant en oeuvre des vues en JSP/JSTL. <br>
L'utilisation de bootstrap serait un plus, vous prendrez soin à ce que vos page soient un minimum présentable et l'utilisation ergonomique. <br>
Les contrôleurs seront configurés à l’aide des annotations spring vues en cours/tp. <br>
Les informations seront persistées à travers des objets définis avec les annotation JPA dans une base de données relationnelles. <br>
Au choix : MySQL, postgres ou H2 database. <br>
Dans tous les cas des indications claires seront données pour initialiser la base de données si nécessaire. <br>
Votre archive doit pouvoir être utilisée comme une application compatible JEE dans Tomcat 8.</p>

<p>
  N'oubliez pas les consignes données en début de module:<br/>
  - chacun commit sa contribution au code, l'activité du git doit être significative de l'investissement de chacun.<br/>
  - Pensez à mettre un fichier texte "README". (nom et prénom de chacun, sujet, procédure d'installation et d'initialisation, difficultés rencontrées, choix particuliers)<br/>
</p>

<p>Votre application devrait pouvoir se lancer en faisant :</p>

<ul>
<li>un 'git clone' de votre projet, </li>
<li>une compilation avec mvn package,</li>
<li>initialiser la base de données si nécessaire (par exemple à l’aide d’un script SQL),</li>
<li>une copie du war généré par maven dans Tomcat,</li>
<li>lancer Tomcat 8.</li>
</ul>

</div>
</body>
</html>